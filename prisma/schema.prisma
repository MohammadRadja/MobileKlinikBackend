datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
}

model User {
  id_user       String         @id @default(uuid()) @db.Char(36)
  username      String         @unique
  password      String
  jabatan       String
  alamat        String
  no_telp       String         @db.VarChar(15)
  email         String         @unique
  created_at    DateTime       @default(now())
  updated_at    DateTime       @updatedAt
  rekam_medis   RekamMedis[]
  hewan         Hewan[]
  appointments  Appointment[]
  pembayaran    Pembayaran[]
  resep         Resep[]
}

model Dokter {
  id_dokter      String         @id @default(uuid()) @db.Char(36)
  nama_dokter    String
  spesialisasi   String
  appointments   Appointment[]
  pembayaran     Pembayaran[]
}

model Hewan {
  id_hewan      String         @id @default(uuid()) @db.Char(36)
  id_user       String
  nama_hewan    String
  jenis_hewan   String
  umur          Int
  berat         Float
  jenis_kelamin String
  rekam_medis   RekamMedis[]
  appointments  Appointment[]
  pembayaran    Pembayaran[]
  user          User?          @relation(fields: [id_user], references: [id_user], onDelete: Cascade, onUpdate: Cascade)
}

model Obat {
  id_obat       String         @id @default(uuid()) @db.Char(36)
  nama_obat     String
  keterangan    String
  rekam_medis   RekamMedis[]
  resep         Resep[]
  pembayaran    Pembayaran[]
}

model RekamMedis {
  id_rekam_medis String         @id @default(uuid()) @db.Char(36)
  id_hewan       String
  id_user        String
  id_obat        String
  keluhan        String
  diagnosa       String
  tgl_periksa    DateTime
  pembayaran     Pembayaran[]
  resep          Resep[]
  hewan          Hewan?        @relation(fields: [id_hewan], references: [id_hewan], onDelete: Cascade, onUpdate: Cascade)
  user           User?         @relation(fields: [id_user], references: [id_user], onDelete: Cascade, onUpdate: Cascade)
  obat           Obat?         @relation(fields: [id_obat], references: [id_obat], onDelete: Cascade, onUpdate: Cascade)
}

model Pembayaran {
  id_pembayaran   String         @id @default(uuid()) @db.Char(36)
  id_rekam_medis  String        
  id_user         String
  id_hewan        String        
  id_dokter       String        
  id_appointment  String         
  id_obat         String        
  id_resep        String        
  tgl_pembayaran  DateTime
  jumlah_pembayaran Float
  rekam_medis     RekamMedis?   @relation(fields: [id_rekam_medis], references: [id_rekam_medis], onDelete: Cascade, onUpdate: Cascade)
  user            User?         @relation(fields: [id_user], references: [id_user], onDelete: Cascade, onUpdate: Cascade)
  hewan           Hewan?        @relation(fields: [id_hewan], references: [id_hewan], onDelete: Cascade, onUpdate: Cascade)
  dokter          Dokter?       @relation(fields: [id_dokter], references: [id_dokter], onDelete: Cascade, onUpdate: Cascade)
  appointment     Appointment?  @relation(fields: [id_appointment], references: [id_appointment], onDelete: Cascade, onUpdate: Cascade)
  obat            Obat?         @relation(fields: [id_obat], references: [id_obat], onDelete: Cascade, onUpdate: Cascade)
  resep           Resep?        @relation(fields: [id_resep], references: [id_resep], onDelete: Cascade, onUpdate: Cascade)
}

model Resep {
  id_resep       String         @id @default(uuid()) @db.Char(36)
  id_user        String
  id_rekam_medis String
  id_obat        String
  jumlah_obat    Int
  pembayaran     Pembayaran[]
  user           User?         @relation(fields: [id_user], references: [id_user], onDelete: Cascade, onUpdate: Cascade)
  rekam_medis    RekamMedis?   @relation(fields: [id_rekam_medis], references: [id_rekam_medis], onDelete: Cascade, onUpdate: Cascade)
  obat           Obat?         @relation(fields: [id_obat], references: [id_obat], onDelete: Cascade, onUpdate: Cascade)
}

model Appointment {
  id_appointment String         @id @default(uuid()) @db.Char(36)
  id_user        String
  id_hewan       String
  id_dokter      String
  tgl_appointment DateTime
  catatan        String?
  pembayaran     Pembayaran[]
  hewan          Hewan?        @relation(fields: [id_hewan], references: [id_hewan], onDelete: Cascade, onUpdate: Cascade)
  dokter         Dokter?       @relation(fields: [id_dokter], references: [id_dokter], onDelete: Cascade, onUpdate: Cascade)
  user          User?         @relation(fields: [id_user], references: [id_user], onDelete: Cascade, onUpdate: Cascade)
}
